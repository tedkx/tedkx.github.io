{"version":3,"file":"static/js/615.05fb9b80.chunk.js","mappings":"wPAEMA,EAAe,SAAAC,GACnB,IAAMC,EAASC,KAAKC,MAAMH,EAASI,EAAAA,GAAAA,QAC7BC,EAAOL,EAASI,EAAAA,GAAAA,OACtB,MAAM,GAAN,OAAUA,EAAAA,GAAMC,IAAhB,OAAwBJ,IAGpBK,EAAa,SAAAC,GACjB,OAA2BA,GAAO,IAAIC,MAAM,oBAAsB,GAAlE,eAAUH,GAAV,WAAgBJ,EAAhB,KACA,OAAQI,GAASJ,EAEbQ,SAASR,GAAUG,EAAAA,GAAAA,OACjBA,EAAAA,GAAAA,WAAgB,SAAAM,GAAC,OAAIA,IAAML,EAAKM,iBAFlC,MAMAC,EAAW,SAAAC,GAAW,OAC1BA,EAAY,IAAMC,EAAAA,IAClBD,EAAY,IAAMC,EAAAA,GAAcC,EAAAA,IAChCF,EAAY,GAAK,GAGbG,EAAY,SAAAH,GAAW,OAC1BA,EAAY,IAAMI,EAAAA,IACjBJ,EAAY,IAAMI,EAAAA,GAAeF,EAAAA,IAClCF,EAAY,IAAMC,EAAAA,IACjBD,EAAY,IAAMC,EAAAA,GAAcC,EAAAA,IACb,IAAnBF,EAAY,K,8EC5BhB,IAAMK,EAAS,SAAAC,GAAG,MAAmB,oBAARA,GAIvBC,EAA2B,SAACC,EAAGC,GAAJ,OAAWD,EAAIC,EAAKC,IAAIF,EAAGC,IAEtDE,EAAsB,sCAAIC,EAAJ,yBAAIA,EAAJ,uBAC1BA,EACGC,MAAM,GACNC,QACC,SAACC,EAASC,GAAV,OAAkBT,EAAyBQ,EAASC,KACpDJ,EAAQ,M,8GCARK,EAAQ,CACZC,WAAY,WACZC,OAAQ,sBACRC,WAAY,eACZC,UAAW,UA+Db,UA5D0B,WACxB,MAA6BC,EAAAA,WAAiBC,EAAAA,GAAtCC,EAAR,EAAQA,MAAOC,EAAf,EAAeA,UACf,EAA0BH,EAAAA,SAAe,IAAzC,eAAOI,EAAP,KAAcC,EAAd,KAEMC,EAAMN,EAAAA,OAAa,CACvBO,MAAO,KACPC,cAAe,EACfC,YAAa,OAGTC,EAAaV,EAAAA,aACjB,SAAAW,GAKE,IAJA,IAAMC,EAAMC,MAAMC,KAAKH,GAEnBI,EAAc,EAChBC,EAAiB,GACZD,EAAc,GAAG,CACtB,IAAME,EAAML,EAAIrB,MAAM,EAAGwB,GAAaG,KAAK,KACrCC,EAAOC,EAAAA,GAAiBH,GAC9B,GAAIE,EAAM,CACRH,EACEG,EAAKE,QAAQ,SAAW,EAAxB,UACOF,EADP,aACevD,EAAAA,EAAAA,IAAagD,EAAI,IADhC,qBACgDA,EAAI,IAChC,IAAhBG,EAAA,UACGI,EADH,kBACiBP,EAAI,IADrB,UAEGO,EAFH,YAEWP,EAAIrB,MAAMwB,GAAaG,KAAK,MAC7C,MAGFH,IAGF,IAAMO,EAAI,UAAMV,EAAI,GAAV,YAAgBA,EAAI,GAApB,YAA0BA,EAAI,GAA9B,cAAsCI,GAChDX,GAAS,SAAAkB,GAAY,OACnBA,EAAahC,MAAMgC,EAAaC,OAAS,KAAKC,OAAOH,QAGzD,CAACjB,IAWH,OARAL,EAAAA,WAAgB,WAId,OAHIE,IACFI,EAAIb,QAAQgB,YAAcN,EAAUO,EAAY,CAAEgB,eAAAA,EAAAA,MAE7C,kBACLxB,IAASnB,EAAAA,EAAAA,IAAOuB,EAAIb,QAAQgB,cAAgBH,EAAIb,QAAQgB,iBACzD,CAACP,KAGF,SAAC,IAAD,CAAMyB,UAAU,EAAOhC,MAAOA,EAA9B,SACGS,EAAMwB,KAAI,SAAAC,GAAI,OACb,gCACGA,GACD","sources":["lib/midi.js","lib/utils.js","routes/Tools/MidiMessageViewer/index.js"],"sourcesContent":["import { noteOnStart, noteOffStart, numOfChannels, notes } from './constants';\r\n\r\nconst noteToString = number => {\r\n  const octave = Math.floor(number / notes.length);\r\n  const note = number % notes.length;\r\n  return `${notes[note]}${octave}`;\r\n};\r\n\r\nconst noteToMidi = str => {\r\n  const [_, note, octave] = (str || '').match(/(.{1,2})(\\d{1})/) || [];\r\n  return !note || !octave\r\n    ? null\r\n    : parseInt(octave) * notes.length +\r\n        notes.findIndex(n => n === note.toUpperCase());\r\n};\r\n\r\n// check for noteOn number\r\nconst isNoteOn = midiMessage =>\r\n  midiMessage[0] >= noteOnStart &&\r\n  midiMessage[0] <= noteOnStart + numOfChannels &&\r\n  midiMessage[2] > 0;\r\n\r\n// either noteOff number or noteOn and velocity is 0\r\nconst isNoteOff = midiMessage =>\r\n  (midiMessage[0] >= noteOffStart &&\r\n    midiMessage[0] <= noteOffStart + numOfChannels) ||\r\n  (midiMessage[0] >= noteOnStart &&\r\n    midiMessage[0] <= noteOnStart + numOfChannels &&\r\n    midiMessage[2] === 0);\r\n\r\nexport { isNoteOn, isNoteOff, noteToMidi, noteToString };\r\n","const isFunc = arg => typeof arg === 'function';\r\n\r\nconst greatestCommonDivisor = (a, b) => (!b ? a : gcd(b, a % b));\r\n\r\nconst leastCommonMultipleInner = (a, b) => (a * b) / gcd(a, b);\r\n\r\nconst leastCommonMultiple = (...numbers) =>\r\n  numbers\r\n    .slice(1)\r\n    .reduce(\r\n      (current, num) => leastCommonMultipleInner(current, num),\r\n      numbers[0]\r\n    );\r\n\r\nexport { greatestCommonDivisor, isFunc, leastCommonMultiple };\r\n","import React from 'react';\r\nimport { Card } from 'antd';\r\nimport MidiContext from 'components/Midi/Context';\r\nimport {\r\n  defaultIgnoreMessages as ignoreMessages,\r\n  MidiMessageCodes,\r\n  MidiMessages,\r\n} from 'lib/enums';\r\nimport { noteToString } from 'lib/midi';\r\nimport { isFunc } from 'lib/utils';\r\n\r\nconst style = {\r\n  fontFamily: 'Consolas',\r\n  height: 'calc(100vh - 108px)',\r\n  textShadow: '1px 1px #222',\r\n  overflowY: 'scroll',\r\n};\r\n\r\nconst MidiMessageViewer = () => {\r\n  const { ready, subscribe } = React.useContext(MidiContext);\r\n  const [lines, setLines] = React.useState([]);\r\n\r\n  const ref = React.useRef({\r\n    start: null,\r\n    numOfMessages: 0,\r\n    unsubscribe: null,\r\n  });\r\n\r\n  const appendLine = React.useCallback(\r\n    data => {\r\n      const arr = Array.from(data);\r\n\r\n      let sliceLength = 3,\r\n        additionalText = '';\r\n      while (sliceLength > 0) {\r\n        const key = arr.slice(0, sliceLength).join('_');\r\n        const type = MidiMessageCodes[key];\r\n        if (type) {\r\n          additionalText =\r\n            type.indexOf('Note') >= 0\r\n              ? `${type} ${noteToString(arr[1])} Velocity ${arr[2]}`\r\n              : sliceLength === 2\r\n              ? `${type} Value ${arr[2]}`\r\n              : `${type} ${arr.slice(sliceLength).join(' ')}`;\r\n          break;\r\n        }\r\n\r\n        sliceLength--;\r\n      }\r\n\r\n      const text = `${arr[0]} ${arr[1]} ${arr[2]} - ${additionalText}`;\r\n      setLines(currentLines =>\r\n        currentLines.slice(currentLines.length - 100).concat(text)\r\n      );\r\n    },\r\n    [setLines]\r\n  );\r\n\r\n  React.useEffect(() => {\r\n    if (ready)\r\n      ref.current.unsubscribe = subscribe(appendLine, { ignoreMessages });\r\n\r\n    return () =>\r\n      ready && isFunc(ref.current.unsubscribe) && ref.current.unsubscribe();\r\n  }, [ready]);\r\n\r\n  return (\r\n    <Card bordered={false} style={style}>\r\n      {lines.map(line => (\r\n        <>\r\n          {line}\r\n          <br />\r\n        </>\r\n      ))}\r\n    </Card>\r\n  );\r\n};\r\n\r\nexport default MidiMessageViewer;\r\n"],"names":["noteToString","number","octave","Math","floor","notes","note","noteToMidi","str","match","parseInt","n","toUpperCase","isNoteOn","midiMessage","noteOnStart","numOfChannels","isNoteOff","noteOffStart","isFunc","arg","leastCommonMultipleInner","a","b","gcd","leastCommonMultiple","numbers","slice","reduce","current","num","style","fontFamily","height","textShadow","overflowY","React","MidiContext","ready","subscribe","lines","setLines","ref","start","numOfMessages","unsubscribe","appendLine","data","arr","Array","from","sliceLength","additionalText","key","join","type","MidiMessageCodes","indexOf","text","currentLines","length","concat","ignoreMessages","bordered","map","line"],"sourceRoot":""}