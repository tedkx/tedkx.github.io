"use strict";(self.webpackChunkmidi_playground=self.webpackChunkmidi_playground||[]).push([[19],{1099:function(e,n,t){t.d(n,{PW:function(){return c},Qz:function(){return a},f5:function(){return s},mr:function(){return i}});var r=t(9439),o=t(4896),a=function(e){var n=Math.floor(e/o.$c.length),t=e%o.$c.length;return"".concat(o.$c[t]).concat(n)},c=function(e){var n=(e||"").match(/(.{1,2})(\d{1})/)||[],t=(0,r.Z)(n,3),a=(t[0],t[1]),c=t[2];return a&&c?parseInt(c)*o.$c.length+o.$c.findIndex((function(e){return e===a.toUpperCase()})):null},i=function(e){return e[0]>=o.wm&&e[0]<=o.wm+o.J5&&e[2]>0},s=function(e){return e[0]>=o.$Z&&e[0]<=o.$Z+o.J5||e[0]>=o.wm&&e[0]<=o.wm+o.J5&&0===e[2]}},5019:function(e,n,t){t.r(n),t.d(n,{default:function(){return ne}});var r=t(9439),o=t(2791),a=t(915),c=t(7557),i=t(9966),s=t(1099),l=t(3433),u=t(6270),d=t(7269),f=t(4896),v={start:10,spaces:[5,1,4]},m={start:4,spaces:[4,2,5]},p="starting",h="testing",y="success",Z="done",C=function(e,n){if("number"!==typeof e)return e;("number"!==typeof n||n<0||n>3)&&(n=1);var t=Math.pow(10,3-n);return Math.round(e/t)*t/1e3},x=t(1413),g=t(184),b=function(e){var n=e.from,t=e.onCompletion,a=o.useState({number:n+1,active:!1}),c=(0,r.Z)(a,2),i=c[0],s=c[1],l=o.useRef({activationPending:!1,timeoutId:null});return o.useEffect((function(){s({number:n+1,active:!1})}),[n]),o.useEffect((function(){var e=i.active,n=i.number;e?l.current.timeoutId=setTimeout((function(){n>1?s((function(e){return(0,x.Z)((0,x.Z)({},e),{},{active:!1})})):t()}),950):l.current.activationPending?(l.current.activationPending=!1,setTimeout((function(){return s((0,x.Z)((0,x.Z)({},i),{},{active:!0}))}),50)):"number"===typeof n&&n>0&&(l.current.activationPending=!0,s({number:n-1,active:!1}))}),[i,t]),o.useEffect((function(){return function(){return clearTimeout(l.current.timeoutId)}}),[]),(0,g.jsx)("div",{className:"countdown",children:(0,g.jsx)("div",{className:"countdown-inner",children:i.number>0&&(0,g.jsx)("div",{className:"countdown-number ".concat(i.active&&"active"),children:i.number})})})},N=t(7462),I=t(4942),w=t(5671),E=t(3144),P=t(136),k=t(8557),j=t(1002),S=t(1694),K=t.n(S),T=t(9613),A=t.n(T),M=t(5501),R=t(5207),$=o.forwardRef((function(e,n){var t,a=e.prefixCls,c=e.forceRender,i=e.className,s=e.style,l=e.children,u=e.isActive,d=e.role,f=o.useState(u||c),v=(0,r.Z)(f,2),m=v[0],p=v[1];return o.useEffect((function(){(c||u)&&p(!0)}),[c,u]),m?o.createElement("div",{ref:n,className:K()("".concat(a,"-content"),(t={},(0,I.Z)(t,"".concat(a,"-content-active"),u),(0,I.Z)(t,"".concat(a,"-content-inactive"),!u),t),i),style:s,role:d},o.createElement("div",{className:"".concat(a,"-content-box")},l)):null}));$.displayName="PanelContent";var Q=$,z=function(e){(0,P.Z)(t,e);var n=(0,k.Z)(t);function t(){var e;(0,w.Z)(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(e=n.call.apply(n,[this].concat(o))).handleItemClick=function(){var n=e.props,t=n.onItemClick,r=n.panelKey;"function"===typeof t&&t(r)},e.handleKeyPress=function(n){"Enter"!==n.key&&13!==n.keyCode&&13!==n.which||e.handleItemClick()},e}return(0,E.Z)(t,[{key:"shouldComponentUpdate",value:function(e){return!A()(this.props,e)}},{key:"render",value:function(){var e,n,t=this,r=this.props,a=r.className,c=r.id,i=r.style,s=r.prefixCls,l=r.header,u=r.headerClass,d=r.children,f=r.isActive,v=r.showArrow,m=r.destroyInactivePanel,p=r.accordion,h=r.forceRender,y=r.openMotion,Z=r.expandIcon,C=r.extra,x=r.collapsible,g="disabled"===x,b=K()("".concat(s,"-header"),(e={},(0,I.Z)(e,u,u),(0,I.Z)(e,"".concat(s,"-header-collapsible-only"),"header"===x),e)),w=K()((n={},(0,I.Z)(n,"".concat(s,"-item"),!0),(0,I.Z)(n,"".concat(s,"-item-active"),f),(0,I.Z)(n,"".concat(s,"-item-disabled"),g),n),a),E=o.createElement("i",{className:"arrow"});v&&"function"===typeof Z&&(E=Z(this.props));var P=null!==C&&void 0!==C&&"boolean"!==typeof C;return o.createElement("div",{className:w,style:i,id:c},o.createElement("div",{className:b,onClick:function(){return"header"!==x&&t.handleItemClick()},role:p?"tab":"button",tabIndex:g?-1:0,"aria-expanded":f,onKeyPress:this.handleKeyPress},v&&E,"header"===x?o.createElement("span",{onClick:this.handleItemClick,className:"".concat(s,"-header-text")},l):l,P&&o.createElement("div",{className:"".concat(s,"-extra")},C)),o.createElement(R.Z,(0,N.Z)({visible:f,leavedClassName:"".concat(s,"-content-hidden")},y,{forceRender:h,removeOnLeave:m}),(function(e,n){var t=e.className,r=e.style;return o.createElement(Q,{ref:n,prefixCls:s,className:t,style:r,isActive:f,forceRender:h,role:p?"tabpanel":null},d)})))}}]),t}(o.Component);z.defaultProps={showArrow:!0,isActive:!1,onItemClick:function(){},headerClass:"",forceRender:!1};var W=z;function _(e){var n=e;if(!Array.isArray(n)){var t=(0,j.Z)(n);n="number"===t||"string"===t?[n]:[]}return n.map((function(e){return String(e)}))}var D=function(e){(0,P.Z)(t,e);var n=(0,k.Z)(t);function t(e){var r;(0,w.Z)(this,t),(r=n.call(this,e)).onClickItem=function(e){var n=r.state.activeKey;if(r.props.accordion)n=n[0]===e?[]:[e];else{var t=(n=(0,l.Z)(n)).indexOf(e);t>-1?n.splice(t,1):n.push(e)}r.setActiveKey(n)},r.getNewChild=function(e,n){if(!e)return null;var t=r.state.activeKey,a=r.props,c=a.prefixCls,i=a.openMotion,s=a.accordion,l=a.destroyInactivePanel,u=a.expandIcon,d=a.collapsible,f=e.key||String(n),v=e.props,m=v.header,p=v.headerClass,h=v.destroyInactivePanel,y=v.collapsible,Z=null!==y&&void 0!==y?y:d,C={key:f,panelKey:f,header:m,headerClass:p,isActive:s?t[0]===f:t.indexOf(f)>-1,prefixCls:c,destroyInactivePanel:null!==h&&void 0!==h?h:l,openMotion:i,accordion:s,children:e.props.children,onItemClick:"disabled"===Z?null:r.onClickItem,expandIcon:u,collapsible:Z};return"string"===typeof e.type?e:o.cloneElement(e,C)},r.getItems=function(){var e=r.props.children;return(0,M.Z)(e).map(r.getNewChild)},r.setActiveKey=function(e){"activeKey"in r.props||r.setState({activeKey:e}),r.props.onChange(r.props.accordion?e[0]:e)};var a=e.activeKey,c=e.defaultActiveKey;return"activeKey"in e&&(c=a),r.state={activeKey:_(c)},r}return(0,E.Z)(t,[{key:"shouldComponentUpdate",value:function(e,n){return!A()(this.props,e)||!A()(this.state,n)}},{key:"render",value:function(){var e,n=this.props,t=n.prefixCls,r=n.className,a=n.style,c=n.accordion,i=K()((e={},(0,I.Z)(e,t,!0),(0,I.Z)(e,r,!!r),e));return o.createElement("div",{className:i,style:a,role:c?"tablist":null},this.getItems())}}],[{key:"getDerivedStateFromProps",value:function(e){var n={};return"activeKey"in e&&(n.activeKey=_(e.activeKey)),n}}]),t}(o.Component);D.defaultProps={prefixCls:"rc-collapse",onChange:function(){},accordion:!1,destroyInactivePanel:!1},D.Panel=W;var J=D,L=(D.Panel,t(1938)),O=t(1818),U=t(3785),B=t(4824),F=function(e){(0,B.Z)(!("disabled"in e),"Collapse.Panel",'`disabled` is deprecated. Please use `collapsible="disabled"` instead.');var n=o.useContext(U.E_).getPrefixCls,t=e.prefixCls,r=e.className,a=void 0===r?"":r,c=e.showArrow,i=void 0===c||c,s=n("collapse",t),l=K()((0,I.Z)({},"".concat(s,"-no-arrow"),!i),a);return o.createElement(J.Panel,(0,N.Z)({},e,{prefixCls:s,className:l}))},H=t(9464),q=t(1113),G=function(e){var n,t=o.useContext(U.E_),r=t.getPrefixCls,a=t.direction,c=e.prefixCls,i=e.className,s=void 0===i?"":i,l=e.bordered,u=void 0===l||l,d=e.ghost,f=r("collapse",c),v=function(){var n=e.expandIconPosition;return void 0!==n?n:"rtl"===a?"right":"left"}(),m=K()((n={},(0,I.Z)(n,"".concat(f,"-borderless"),!u),(0,I.Z)(n,"".concat(f,"-icon-position-").concat(v),!0),(0,I.Z)(n,"".concat(f,"-rtl"),"rtl"===a),(0,I.Z)(n,"".concat(f,"-ghost"),!!d),n),s),p=(0,N.Z)((0,N.Z)({},H.ZP),{motionAppear:!1,leavedClassName:"".concat(f,"-content-hidden")});return o.createElement(J,(0,N.Z)({openMotion:p},e,{expandIcon:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.expandIcon,r=t?t(n):o.createElement(L.Z,{rotate:n.isActive?90:void 0});return o.createElement("div",null,(0,q.Tm)(r,(function(){return{className:K()(r.props.className,"".concat(f,"-arrow"))}})))},prefixCls:f,className:m}),function(){var n=e.children;return(0,M.Z)(n).map((function(e,n){var t;if(null===(t=e.props)||void 0===t?void 0:t.disabled){var r=e.key||String(n),o=e.props,a=o.disabled,c=o.collapsible,i=(0,N.Z)((0,N.Z)({},(0,O.Z)(e.props,["disabled"])),{key:r,collapsible:null!==c&&void 0!==c?c:a?"disabled":void 0});return(0,q.Tm)(e,i)}return e}))}())};G.Panel=F;var V=G,X=function(e){var n=e.children,t=e.className,r=e.in,a=e.style,c=o.useMemo((function(){return Boolean(r)?"1":null}),[r]);return(0,g.jsx)("div",{className:"simpleCollapse ".concat(t),style:a,children:(0,g.jsx)(V,{bordered:!1,activeKey:c,children:(0,g.jsx)(V.Panel,{header:"1",children:n},"1")})})},Y=function(e){var n=e.scenario,t=o.useRef({doneTimeoutId:null}),x=function(e,n){var t=e.scenario,a=o.useContext(u.Z).selectedInput,c=o.useState([]),i=(0,r.Z)(c,2),v=i[0],m=i[1],p=o.useState([]),h=(0,r.Z)(p,2),y=h[0],Z=h[1];o.useEffect((function(){Z([])}),[t]);var C=o.useMemo((function(){if(!t)return null;for(var e=(0,s.PW)("".concat(t.note,"0")),n=(0,s.PW)("".concat(t.note,"8")),r=[],o=e,a=0,c=0;o<=n;)r.push(o),o+=f.QL.altered[a],++a>=f.QL.altered.length&&(a=0,c++,o=(0,s.PW)("".concat(t.note).concat(c)));return r}),[t]);return o.useEffect((function(){a&&a.state===d.re.Connected&&(a.onmidimessage=function(e){var t=e.data,o=(0,r.Z)(t,2),a=o[0],c=o[1];a!==f.wm&&a!==f.$Z||((0,s.mr)(t)?(clearTimeout(n.current.doneTimeoutId),m((function(e){return[].concat((0,l.Z)(e),[c]).sort()})),C.includes(c)||Z((function(e){return[].concat((0,l.Z)(e),[c])}))):(0,s.f5)(t)&&(m((function(e){return e.filter((function(e){return e!==c}))})),C.includes(c)||setTimeout((function(){return Z((function(e){return e.filter((function(e){return e!==c}))}))}),3e3)))})}),[a,C]),{activeNotes:v,scenarioNotes:C,wrongNotes:y}}(e,t),N=x.activeNotes,I=x.scenarioNotes,w=x.wrongNotes,E=function(e,n,t){var a=e.onCompletion,c=e.scenario,i=o.useState(p),l=(0,r.Z)(i,2),u=l[0],d=l[1];o.useEffect((function(){d(p)}),[c]);var f=o.useCallback((function(){return d(h)}),[d]);return o.useEffect((function(){if(!(u!==h||n.length<4)){var e=1===c.inversion?v:m,t=e.spaces,r=e.start,o=(0,s.Qz)(n[0]-r);if(o.substr(0,o.length-1)===c.note){for(var a=0;a<t.length;){if(n[a+1]-n[a]!==t[a])return;a++}d(y)}}}),[n,u,c]),o.useEffect((function(){u===y&&0===n.length&&(t.current.doneTimeoutId=setTimeout((function(){d(Z),a()}),1e3))}),[n,u]),{handleCountdownCompletion:f,scenarioStatus:u}}(e,N,t),P=E.handleCountdownCompletion,k=E.scenarioStatus,j=function(e,n,t){var a=e.scenario,c=o.useRef({helpTimeoutId:null,scenarioStatus:t}),i=o.useState(null),l=(0,r.Z)(i,2),u=l[0],d=l[1];o.useEffect((function(){c.current.scenarioStatus=t}),[t]);var f=o.useCallback((function(){clearTimeout(c.current.helpTimeoutId),d(null)}),[]);return o.useEffect((function(){f()}),[a]),o.useEffect((function(){a&&t===h?c.current.helpTimeoutId=setTimeout((function(){if(c.current.scenarioStatus===h){var e=1===a.inversion?v:m,t=e.start,r=e.spaces.reduce((function(e,n){return e.push(e[e.length-1]+n),e}),[n[0]+t]);d(r.map((function(e){var n=(0,s.Qz)(e);return n.substr(0,n.length-1)})).join(" "))}}),6e3):f()}),[a,t]),u}(e,I,k),S=function(e){var n=o.useState([]),t=(0,r.Z)(n,2),a=t[0],c=t[1],i=o.useState(null),s=(0,r.Z)(i,2),l=s[0],u=s[1];o.useEffect((function(){e===h?u(new Date):e===y&&(c((function(e){return(e.length<=100?e:e.slice(e.length-100)).concat(new Date-l)})),u(null))}),[e]);var d=o.useMemo((function(){return a.length?C(a.reduce((function(e,n){return e+n}),0)/a.length):null}),[a]);return{time:o.useMemo((function(){return a[a.length-1]?C(a[a.length-1]):0}),[a]),meanTime:d}}(k),K=S.time,T=S.meanTime;return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)(a.Z,{bordered:!1,className:"altered-scenario",children:[k===p&&n&&(0,g.jsx)(b,{from:2,onCompletion:P}),k!==p&&(0,g.jsxs)("div",{className:"scenario-title",children:[n.note," Inv",n.inversion,(0,g.jsxs)(X,{in:k===y,children:[(0,g.jsx)(c.Z,{}),(0,g.jsx)("br",{}),(0,g.jsxs)("span",{className:"time ".concat(K>T?"slow":"fast"),children:[K," secs"]})]})]}),(0,g.jsxs)(X,{className:"help",in:null!==j,children:[(0,g.jsx)(i.Z,{}),j]}),(0,g.jsx)(X,{className:"wrong-notes-wrap",in:w.length,children:w.map((function(e){return(0,s.Qz)(e)})).join(" ")})]}),T&&(0,g.jsxs)(a.Z,{bordered:!1,style:{textAlign:"right"},children:[" ","Mean Time: ",(0,g.jsxs)("strong",{children:[T," secs"]})]})]})},ee=f.$c.reduce((function(e,n){return e.push({note:n,inversion:1}),e.push({note:n,inversion:2}),e}),[]),ne=function(){var e=o.useState(null),n=(0,r.Z)(e,2),t=n[0],c=n[1],i=o.useCallback((function(){for(var e=Math.random()*ee.length,n=t;n===t;)n=ee[Math.floor(e)];c(n)}),[t,c]);return o.useEffect((function(){i()}),[]),(0,g.jsxs)("div",{children:[(0,g.jsxs)(a.Z,{bordered:!1,children:[(0,g.jsx)("h2",{children:"Altered Scale Random Chord Practice"}),"Play the chord displayed in altered scale on your left hand. Help will be displayed if you take too long.",(0,g.jsx)("br",{}),"Inversion 1 starts from the minor 7th (ie for C: B). Inversion 2 starts from the major 3rd (ie for C: E)."]}),(0,g.jsx)(Y,{onCompletion:i,scenario:t})]})}}}]);
//# sourceMappingURL=19.5bf97bed.chunk.js.map