"use strict";(self.webpackChunkmidi_playground=self.webpackChunkmidi_playground||[]).push([[432],{6985:function(e,n,t){t.d(n,{PW:function(){return c},Qz:function(){return o},f5:function(){return i},mr:function(){return l}});var r=t(9439),a=t(4896),o=function(e){var n=Math.floor(e/a.$c.length),t=e%a.$c.length;return"".concat(a.$c[t]).concat(n)},c=function(e){var n=(e||"").match(/(.{1,2})(\d{1})/)||[],t=(0,r.Z)(n,3),o=(t[0],t[1]),c=t[2];return o&&c?parseInt(c)*a.$c.length+a.$c.findIndex((function(e){return e===o.toUpperCase()})):null},l=function(e){return e[0]>=a.wm&&e[0]<=a.wm+a.J5&&e[2]>0},i=function(e){return e[0]>=a.$Z&&e[0]<=a.$Z+a.J5||e[0]>=a.wm&&e[0]<=a.wm+a.J5&&0===e[2]}},6432:function(e,n,t){t.r(n),t.d(n,{default:function(){return De}});var r,a=t(1413),o=t(5987),c=t(9439),l=t(2791),i=t(6985),s=function(e,n,t,r,a){return{centerBased:!0===a,defaultValue:t,max:n,min:e,title:r}},u=(r={bpm:120,noteDuration:600,notes:"C5 A#4 C5 G#5:90 C#5 G#4 D#5 C5 A#4 G#5:90 C5 G#4 C#5 D#5 A#4 C5 G#5:90 G#5:0 C5 A#4 C5 G#5 C5 A#4 C5 G#5:90 C#5 G#4 D#5 C5 A#4 G5:90 C5 G#4 C#5 D#5 A#4 C#5 A#5:90 A#5:0 C5 A#4 C5 G#5:90 C#5 G#4 D#5 C5 A#4 G#5:90 C5 G#4 C#5 D#5 A#4 C5 G#5:90 G#5:0 C5 A#4 C5 G#5 C5 A#4 C5 G#5:90 C#5 G#4 D#5 C5 A#4 G5:90 A#4 G#4 C#5 D#5 A#4 C#5 C6:90 C6:0",noteValue:16,velocity:54},(0,a.Z)((0,a.Z)({},r),{},{notes:r.notes.split(" ").map((function(e){var n=e.split(":"),t=(0,c.Z)(n,2),a=t[0],o=t[1],l=parseInt(o);return{note:(0,i.PW)(a),on:0!==l,velocity:isNaN(l)?r.velocity||64:l}}))})),d={noteDuration:s(1,1e3,u.noteDuration,"Note Duration"),transpose:s(-24,24,0,"Transpose",!0)},m={bpm:s(40,280,u.bpm,"Tempo"),noteValue:s(1,32,u.noteValue,"NoteValue")},f=t(4942),v=t(6270),p=t(7269),h=["notes"],C=["notes"],g=["bpm","noteValue"],y=function(e,n){return 6e4/e*4/n},x=function(e){if(!Array.isArray(e))return[];for(var n=e[0].notes.length,t=0;t<e.length;t++)e[t].length>n&&(n=e[t].length);return Array.from(Array(n)).map((function(n,t){return e.map((function(e){var n=e.channels,r=e.notes,a=e.noteDuration,o=e.transpose;return{channels:n,duration:a,note:r[t].note+o,on:r[t].on,velocity:r[t].velocity}}))}))},b=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=l.useState(e.reduce((function(e,t){return e[t.name]=n[t.name]||t.defaultValue,e}),{})),r=(0,c.Z)(t,2),o=r[0],i=r[1],s=l.useCallback((function(e,n){return i((function(t){return(0,a.Z)((0,a.Z)({},t),{},(0,f.Z)({},e,n))}))}),[]);return{onSetParameter:s,parameters:o}},Z=t(184),N=["children","className","index","onClick"],k=function(e){var n=e.children,t=e.className,r=(e.index,e.onClick),c=(0,o.Z)(e,N);return(0,Z.jsxs)("div",(0,a.Z)((0,a.Z)({className:"keyboard-button ".concat(t),onClick:r},c),{},{children:[(0,Z.jsx)("div",{className:"button-overlay"}),(0,Z.jsx)("div",{className:"button-inner",children:n})]}))},w=["active","children","className","index","on","onClick","onWheel"],j=function(e){var n=e.active,t=e.children,r=e.className,c=e.index,i=e.on,s=e.onClick,u=e.onWheel,d=(0,o.Z)(e,w),m=l.useCallback((function(e){s&&s(c,i,e)}),[c,i,s]),f=l.useCallback((function(e){u&&u(c,e.deltaY<0?"up":"down",e)}),[c,u]);return(0,Z.jsxs)("div",(0,a.Z)((0,a.Z)({className:"keyboard-pad ".concat(r," ").concat(n&&"active"," ").concat(i&&"on"),onClick:m,onWheel:f},d),{},{children:[(0,Z.jsx)("div",{className:"pad-overlay"}),(0,Z.jsx)("div",{className:"pad-inner",children:t})]}))},E=t(763),O=-144,I=function(e){var n=e.centerBased,t=e.className,r=e.displayValue,o=e.max,i=e.min,s=e.style,u=e.title,d=e.value,m=l.useMemo((function(){return function(e,n,t){var r=288*(e-n)/(t-n)+O;return Math.max(O,Math.min(144,r))}(d,i,o)}),[d,i,o]),f=function(e){var n=e.max,t=e.min,r=e.onSetValue,a=e.step,o=void 0===a?1:a,c=e.value,i=l.useRef({factor:1,max:n,min:t,step:o,value:c}),s=l.useRef();l.useEffect((function(){i.current.step=o,i.current.value=c,i.current.min=t,i.current.max=n}),[c,o,t,n]);var u=l.useMemo((function(){return(0,E.debounce)((function(){i.current.factor=i.current.step}),25)}),[]);return l.useEffect((function(){var e=function(e){e.stopPropagation(),e.stopImmediatePropagation(),e.preventDefault();var n=i.current,t=n.value,a=n.step,o=n.min,c=n.max,l=t+a*i.current.factor*(e.deltaY<0?1:-1);r(Math.min(c,Math.max(o,l))),i.current.factor+=a,u()};return s.current.addEventListener("wheel",e,{passive:!1}),function(){s.current.removeEventListener("wheel",e,{passive:!1})}}),[]),{elementRef:s}}(e),v=(f.onWheel,f.elementRef),p=function(e){var n=e.max,t=e.min,r=e.onSetValue,a=e.value,o=l.useRef({y:null,mouseMovelistener:null,mouseUplistener:null,mouseDown:!1,value:a}),i=l.useState(!1),s=(0,c.Z)(i,2),u=s[0],d=s[1];l.useEffect((function(){o.current.value=a}),[a]);var m=l.useCallback((function(e){0===e.button&&(d(!1),window.removeEventListener("mousemove",o.current.mouseMovelistener),window.removeEventListener("mouseup",o.current.mouseUplistener),o.current.listener=null)}),[d]),f=l.useCallback((function(e){var a=Math.min(n,Math.max(t,o.current.value+o.current.y-e.pageY));o.current.y=e.pageY,r(a)}),[r,t,n]);return{dragging:u,onMouseDown:l.useCallback((function(e){0===e.button&&(d(!0),o.current.y=e.pageY,o.current.mouseMovelistener=f,o.current.mouseUplistener=m,window.addEventListener("mousemove",o.current.mouseMovelistener),window.addEventListener("mouseup",o.current.mouseUplistener))}),[])}}(e),h=p.dragging,C=p.onMouseDown;return(0,Z.jsxs)("div",{className:"rotary-knob ".concat(r&&"with-value"," ").concat(u&&"with-title"," ").concat(t),style:s,children:[h&&(0,Z.jsx)("div",{className:"window-overlay"}),u&&(0,Z.jsx)("div",{className:"title",children:u}),(0,Z.jsx)("div",{className:"knob-overlay",onMouseDown:C,ref:v}),(0,Z.jsxs)("div",{className:"knob-inner",children:[(0,Z.jsx)("div",{className:"marker",style:{transform:"rotate(".concat(m,"deg)")}}),(0,Z.jsx)("div",{className:"ticks",children:Array.from(Array(25)).map((function(e,t){return(0,Z.jsx)("div",(0,a.Z)({},function(e,n,t){var r=O+12*e;return{className:"tick ".concat((t?n<0?r<=0&&r>=n:r>=0&&r<=n:n>O&&r<=n)&&"active"),key:e,style:{transform:"rotate(".concat(r,"deg)")}}}(t,m,n)),t)}))})]}),r&&(0,Z.jsx)("div",{className:"value-wrap",children:(0,Z.jsx)("div",{className:"value-display",children:d})})]})},D=["name","onSetParameter"],S=function(e){var n=e.name,t=e.onSetParameter,r=(0,o.Z)(e,D),c=l.useCallback((function(e){return t(n,e)}),[n,t]);return(0,Z.jsx)("div",{className:"parameter-knob",children:(0,Z.jsx)(I,(0,a.Z)({displayValue:!0,onSetValue:c},r))})},P=t(915),A={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M347.6 528.95l383.2 301.02c14.25 11.2 35.2 1.1 35.2-16.95V210.97c0-18.05-20.95-28.14-35.2-16.94L347.6 495.05a21.53 21.53 0 000 33.9M330 864h-64a8 8 0 01-8-8V168a8 8 0 018-8h64a8 8 0 018 8v688a8 8 0 01-8 8"}}]},name:"step-backward",theme:"outlined"},M=t(4291),G=function(e,n){return l.createElement(M.Z,(0,a.Z)((0,a.Z)({},e),{},{ref:n,icon:A}))};G.displayName="StepBackwardOutlined";var R=l.forwardRef(G),V={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M715.8 493.5L335 165.1c-14.2-12.2-35-1.2-35 18.5v656.8c0 19.7 20.8 30.7 35 18.5l380.8-328.4c10.9-9.4 10.9-27.6 0-37z"}}]},name:"caret-right",theme:"outlined"},T=function(e,n){return l.createElement(M.Z,(0,a.Z)((0,a.Z)({},e),{},{ref:n,icon:V}))};T.displayName="CaretRightOutlined";var L=l.forwardRef(T),_={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M304 176h80v672h-80zm408 0h-64c-4.4 0-8 3.6-8 8v656c0 4.4 3.6 8 8 8h64c4.4 0 8-3.6 8-8V184c0-4.4-3.6-8-8-8z"}}]},name:"pause",theme:"outlined"},z=function(e,n){return l.createElement(M.Z,(0,a.Z)((0,a.Z)({},e),{},{ref:n,icon:_}))};z.displayName="PauseOutlined";var B=l.forwardRef(z),W=Object.keys(m).map((function(e){return(0,a.Z)((0,a.Z)({},m[e]),{},{name:e})})),q=function(e){var n=e.onPlay,t=e.onSeekToStart,r=e.onSetParameter,o=e.onStop,c=e.parameters;return(0,Z.jsx)("div",{className:"global-controls",children:(0,Z.jsxs)(P.Z,{bordered:!1,children:[(0,Z.jsxs)("div",{className:"control-row",children:[(0,Z.jsx)(k,{onClick:t,children:(0,Z.jsx)(R,{})}),(0,Z.jsx)(k,{onClick:n,children:(0,Z.jsx)(L,{})}),(0,Z.jsx)(k,{onClick:o,children:(0,Z.jsx)(B,{})})]}),(0,Z.jsx)("div",{className:"control-row",children:W.map((function(e){return(0,l.createElement)(S,(0,a.Z)((0,a.Z)({},e),{},{key:e.name,onSetParameter:r,value:c[e.name]}))}))})]})})},$=t(3433),U=t(9333),Y=t(7462),H=t(1694),J=t.n(H),K=t(5179),F=t(1354),Q=l.forwardRef((function(e,n){var t,r=e.prefixCls,a=void 0===r?"rc-switch":r,i=e.className,s=e.checked,u=e.defaultChecked,d=e.disabled,m=e.loadingIcon,v=e.checkedChildren,p=e.unCheckedChildren,h=e.onClick,C=e.onChange,g=e.onKeyDown,y=(0,o.Z)(e,["prefixCls","className","checked","defaultChecked","disabled","loadingIcon","checkedChildren","unCheckedChildren","onClick","onChange","onKeyDown"]),x=(0,K.Z)(!1,{value:s,defaultValue:u}),b=(0,c.Z)(x,2),Z=b[0],N=b[1];function k(e,n){var t=Z;return d||(N(t=e),null===C||void 0===C||C(t,n)),t}var w=J()(a,i,(t={},(0,f.Z)(t,"".concat(a,"-checked"),Z),(0,f.Z)(t,"".concat(a,"-disabled"),d),t));return l.createElement("button",Object.assign({},y,{type:"button",role:"switch","aria-checked":Z,disabled:d,className:w,ref:n,onKeyDown:function(e){e.which===F.Z.LEFT?k(!1,e):e.which===F.Z.RIGHT&&k(!0,e),null===g||void 0===g||g(e)},onClick:function(e){var n=k(!Z,e);null===h||void 0===h||h(n,e)}}),m,l.createElement("span",{className:"".concat(a,"-inner")},Z?v:p))}));Q.displayName="Switch";var X=Q,ee=t(7106),ne=t(2833),te=t(3785),re=t(1815),ae=t(4824),oe=function(e,n){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(t[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)n.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(t[r[a]]=e[r[a]])}return t},ce=l.forwardRef((function(e,n){var t,r=e.prefixCls,a=e.size,o=e.loading,c=e.className,i=void 0===c?"":c,s=e.disabled,u=oe(e,["prefixCls","size","loading","className","disabled"]);(0,ae.Z)("checked"in u||!("value"in u),"Switch","`value` is not a valid prop, do you mean `checked`?");var d=l.useContext(te.E_),m=d.getPrefixCls,v=d.direction,p=l.useContext(re.Z),h=m("switch",r),C=l.createElement("div",{className:"".concat(h,"-handle")},o&&l.createElement(ee.Z,{className:"".concat(h,"-loading-icon")})),g=J()((t={},(0,f.Z)(t,"".concat(h,"-small"),"small"===(a||p)),(0,f.Z)(t,"".concat(h,"-loading"),o),(0,f.Z)(t,"".concat(h,"-rtl"),"rtl"===v),t),i);return l.createElement(ne.Z,{insertExtraNode:!0},l.createElement(X,(0,Y.Z)({},u,{prefixCls:h,className:g,disabled:s||o,ref:n,loadingIcon:C})))}));ce.__ANT_SWITCH=!0,ce.displayName="Switch";var le=ce,ie=t(1002),se=t(3241),ue=t(1938),de=t(5033),me=t(7309),fe=function(e,n){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(t[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)n.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(t[r[a]]=e[r[a]])}return t},ve=me.Z.Group,pe=function(e){var n=l.useContext(te.E_),t=n.getPopupContainer,r=n.getPrefixCls,a=n.direction,o=e.prefixCls,i=e.type,s=void 0===i?"default":i,u=e.disabled,d=e.loading,m=e.onClick,f=e.htmlType,v=e.children,p=e.className,h=e.overlay,C=e.trigger,g=e.align,y=e.visible,x=e.onVisibleChange,b=e.placement,Z=e.getPopupContainer,N=e.href,k=e.icon,w=void 0===k?l.createElement(de.Z,null):k,j=e.title,E=e.buttonsRender,O=void 0===E?function(e){return e}:E,I=e.mouseEnterDelay,D=e.mouseLeaveDelay,S=e.overlayClassName,P=e.overlayStyle,A=e.destroyPopupOnHide,M=fe(e,["prefixCls","type","disabled","loading","onClick","htmlType","children","className","overlay","trigger","align","visible","onVisibleChange","placement","getPopupContainer","href","icon","title","buttonsRender","mouseEnterDelay","mouseLeaveDelay","overlayClassName","overlayStyle","destroyPopupOnHide"]),G=r("dropdown-button",o),R={align:g,overlay:h,disabled:u,trigger:u?[]:C,onVisibleChange:x,getPopupContainer:Z||t,mouseEnterDelay:I,mouseLeaveDelay:D,overlayClassName:S,overlayStyle:P,destroyPopupOnHide:A};"visible"in e&&(R.visible=y),R.placement="placement"in e?b:"rtl"===a?"bottomLeft":"bottomRight";var V=O([l.createElement(me.Z,{type:s,disabled:u,loading:d,onClick:m,htmlType:f,href:N,title:j},v),l.createElement(me.Z,{type:s,icon:w})]),T=(0,c.Z)(V,2),L=T[0],_=T[1];return l.createElement(ve,(0,Y.Z)({},M,{className:J()(G,p)}),L,l.createElement(be,R,_))};pe.__ANT_BUTTON=!0;var he=pe,Ce=t(9393),ge=t(1113),ye=t(9631),xe=((0,Ce.b)("topLeft","topCenter","topRight","bottomLeft","bottomCenter","bottomRight","top","bottom"),function(e){var n,t=l.useContext(te.E_),r=t.getPopupContainer,a=t.getPrefixCls,o=t.direction,c=e.arrow,i=e.prefixCls,s=e.children,u=e.trigger,d=e.disabled,m=e.getPopupContainer,v=e.overlayClassName,p=a("dropdown",i),h=l.Children.only(s),C=(0,ge.Tm)(h,{className:J()("".concat(p,"-trigger"),(0,f.Z)({},"".concat(p,"-rtl"),"rtl"===o),h.props.className),disabled:d}),g=J()(v,(0,f.Z)({},"".concat(p,"-rtl"),"rtl"===o)),y=d?[]:u;y&&-1!==y.indexOf("contextMenu")&&(n=!0);var x=(0,ye.Z)({arrowPointAtCenter:"object"===(0,ie.Z)(c)&&c.pointAtCenter,autoAdjustOverflow:!0});return l.createElement(se.Z,(0,Y.Z)({alignPoint:n},e,{builtinPlacements:x,arrow:!!c,overlayClassName:g,prefixCls:p,getPopupContainer:m||r,transitionName:function(){var n=a(),t=e.placement,r=void 0===t?"":t,o=e.transitionName;return void 0!==o?o:r.indexOf("top")>=0?"".concat(n,"-slide-down"):"".concat(n,"-slide-up")}(),trigger:y,overlay:function(){return function(n){var t,r=e.overlay;t="function"===typeof r?r():r;var a=(t=l.Children.only("string"===typeof t?l.createElement("span",null,t):t)).props;(0,ae.Z)(!a.mode||"vertical"===a.mode,"Dropdown",'mode="'.concat(a.mode,"\" is not supported for Dropdown's Menu."));var o=a.selectable,c=void 0!==o&&o,i=a.expandIcon,s="undefined"!==typeof i&&l.isValidElement(i)?i:l.createElement("span",{className:"".concat(n,"-menu-submenu-arrow")},l.createElement(ue.Z,{className:"".concat(n,"-menu-submenu-arrow-icon")}));return"string"===typeof t.type?t:(0,ge.Tm)(t,{mode:"vertical",selectable:c,expandIcon:s})}(p)},placement:function(){var n=e.placement;if(!n)return"rtl"===o?"bottomRight":"bottomLeft";if(n.includes("Center")){var t=n.slice(0,n.indexOf("Center"));return(0,ae.Z)(!n.includes("Center"),"Dropdown","You are using '".concat(n,"' placement in Dropdown, which is deprecated. Try to use '").concat(t,"' instead.")),t}return n}()}),C)});xe.Button=he,xe.defaultProps={mouseEnterDelay:.15,mouseLeaveDelay:.1};var be=xe,Ze=be,Ne=["channels"],ke=function(e){var n=e.channels,t=e.numOfChannels,r=e.onSetData,i=e.title,s=void 0===i?"Channels":i,u=l.useState(!1),d=(0,c.Z)(u,2),m=d[0],f=d[1],v=l.useCallback((function(){return f(!0)}),[f]),p=l.useCallback((function(e,n){return r((function(t){var r=t.channels,c=(0,o.Z)(t,Ne);return(0,a.Z)((0,a.Z)({},c),{},{channels:n?Array.from(new Set([].concat((0,$.Z)(r),[e]))).sort((function(e,n){return e>n?1:e<n?-1:0})):r.filter((function(n){return n!==e}))})}))}),[t,r]),h=l.useMemo((function(){return(0,Z.jsx)(U.Z,{className:"midi-channels-menu",onClick:v,children:Array.from(Array(t)).map((function(e,t){return(0,Z.jsx)(U.Z.Item,{children:(0,Z.jsxs)("div",{className:"menu-item",children:[(0,Z.jsxs)("div",{children:[t+1," "]}),(0,Z.jsx)(le,{checked:n.includes(t+1),onChange:function(e){return p(t+1,e)},size:"small"})]})},t+1)}))})}),[n,t]),C=l.useMemo((function(){if(!n)return"";var e=n.reduce((function(e,n){return e.range.length>0&&n-e.range[e.range.length-1]>1?e.other.push(n):e.range.push(n),e}),{range:[],other:[]}),t=e.range,r=e.other;return t.length>1?"".concat(t[0],"-").concat(t[t.length-1]).concat(r.length>0?"..":""):[].concat((0,$.Z)(t),(0,$.Z)(r)).filter((function(e,n){return n<3})).join(",")+(r.length>2?"..":"")}),[n]);return(0,Z.jsx)("div",{className:"midi-channels",children:(0,Z.jsx)(Ze,{onVisibleChange:f,overlay:h,placement:"bottomRight",visible:m,children:(0,Z.jsxs)("div",{children:[(0,Z.jsx)("div",{className:"title",children:s}),(0,Z.jsx)("div",{className:"content",children:C})]})})})},we=t(4896),je=Object.keys(d).map((function(e){return(0,a.Z)((0,a.Z)({},d[e]),{},{name:e})})),Ee=function(e){var n=e.activeNoteIdx,t=e.data,r=e.onSetData,c=t.noteDuration,s=t.transpose,u=l.useMemo((function(){return{noteDuration:c,transpose:s}}),[c,s]),d=b(je,u),m=d.parameters,f=d.onSetParameter;l.useEffect((function(){return r((function(e){return(0,a.Z)((0,a.Z)({},e),m)}))}),[m]);var v,p=(v=r,{onClick:l.useCallback((function(e){return v((function(n){var t=n.notes,r=(0,o.Z)(n,h);return(0,a.Z)((0,a.Z)({},r),{},{notes:t.map((function(n,t){return t===e?(0,a.Z)((0,a.Z)({},n),{},{on:!n.on}):n}))})}))}),[v]),onWheel:l.useCallback((function(e,n){return v((function(t){var r=t.notes,c=(0,o.Z)(t,C);return(0,a.Z)((0,a.Z)({},c),{},{notes:r.map((function(t,r){return r===e?(0,a.Z)((0,a.Z)({},t),{},{note:"up"===n?t.note+1:t.note-1}):t}))})}))}),[v])});return(0,Z.jsxs)("div",{className:"step-sequencer",children:[(0,Z.jsx)("div",{className:"controls",children:(0,Z.jsxs)(P.Z,{bordered:!1,children:[(0,Z.jsx)(ke,{channels:null===t||void 0===t?void 0:t.channels,numOfChannels:we.J5,onSetData:r,title:"Channels"}),je.map((function(e){return(0,l.createElement)(S,(0,a.Z)((0,a.Z)({},e),{},{key:e.name,onSetParameter:f,value:m[e.name]}))}))]})}),(0,Z.jsx)("div",{className:"pads-container",children:Array.isArray(null===t||void 0===t?void 0:t.notes)&&t.notes.map((function(e,t){var r=e.note,o=e.on;return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(j,(0,a.Z)((0,a.Z)({active:n===t,index:t,on:o},p),{},{children:(0,i.Qz)(r)}),r),(t+1)%8===0&&(0,Z.jsx)("div",{className:"flex-breaker"})]})}))})]})},Oe=["activeNoteIdx"],Ie=[1,2,3,4],De=function(){var e=l.useState([{channels:Ie,noteDuration:u.noteDuration,notes:u.notes,transpose:0}]),n=(0,c.Z)(e,2),t=n[0],r=n[1],i=l.useState(0),s=(0,c.Z)(i,2),d=s[0],m=(s[1],l.useCallback((function(e){var n="function"===typeof e?e:function(){return e};r((function(e){return e.map((function(e,t){return t===d?n(e):e}))}))}),[r,d])),f=b(W),h=f.parameters,C=f.onSetParameter,N=function(e,n,t){var r=e.bpm,i=e.noteValue,s=(0,o.Z)(e,g),u=l.useContext(v.Z),d=u.selectedOutput,m=l.useState(null),f=(0,c.Z)(m,2),h=f[0],C=f[1],b=l.useRef((0,a.Z)((0,a.Z)({},s),{},{intervalId:null,intervalMillis:y(r,i),noteIdx:0,steps:x(n),tempoChangeRequested:null}));l.useEffect((function(){null!==b.current.intervalId?b.current.tempoChangeRequested=y(r,i):b.current.intervalMillis=y(r,i)}),[r,i]),l.useEffect((function(){Object.keys(s).forEach((function(e){b.current[e]=s[e]}))}),[s]),l.useEffect((function(){b.current.steps=x(n)}),[n]);var Z=l.useCallback((function(){var e=b.current,n=e.steps,t=e.noteIdx,r=e.tempoChangeRequested;r&&(clearInterval(b.current.intervalId),b.current.intervalMillis=r,b.current.tempoChangeRequested=null,b.current.intervalId=setInterval(Z,r));var a=n[t];C(t),b.current.noteIdx++,b.current.noteIdx>=n.length&&(b.current.noteIdx=0);var o=a.reduce((function(e,n){var t=n.channels,r=n.duration,a=n.note,o=n.on,c=n.velocity;return o&&c>0&&t.forEach((function(n){e.messages.push([p.XR["Channel".concat(n,"NoteOn")],a,c]),e.messagesOffGroups[r]||(e.messagesOffGroups[r]=[]),e.messagesOffGroups[r].push([p.XR["Channel".concat(n,"NoteOn")],a,0])})),e}),{messages:[],messagesOffGroups:{}}),c=o.messages,l=o.messagesOffGroups;c.length&&(c.forEach((function(e){return d.send(e)})),Object.keys(l).forEach((function(e){var n=l[e];setTimeout((function(){return n.forEach((function(e){return d.send(e)}))}),e)})))}),[d]);l.useEffect((function(){return t&&null!==u&&void 0!==u&&u.ready&&u.selectedOutput&&(b.current.intervalId=setInterval(Z,intervalMillis)),function(){clearInterval(b.current.intervalId),b.current.intervalId=null}}),[t]);var N=l.useCallback((function(){C(0),b.current.noteIdx=0}),[C]);return{activeNoteIdx:h,onPlay:l.useCallback((function(){null===b.current.intervalId&&(b.current.intervalId=setInterval(Z,b.current.intervalMillis))}),[Z]),onSeekToStart:N,onStop:l.useCallback((function(){clearInterval(b.current.intervalId),b.current.intervalId=null}),[])}}(h,t),k=N.activeNoteIdx,w=(0,o.Z)(N,Oe);return(0,Z.jsxs)("div",{className:"sequencer",children:[(0,Z.jsx)(q,(0,a.Z)((0,a.Z)({},w),{},{parameters:h,onSetParameter:C})),(0,Z.jsx)("div",{className:"step-sequencer",children:(0,Z.jsx)(Ee,{activeNoteIdx:k,data:t[d],onSetData:m})})]})}}}]);
//# sourceMappingURL=432.727a062d.chunk.js.map